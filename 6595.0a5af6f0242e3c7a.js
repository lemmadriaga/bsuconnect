"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6595],{6595:(F,p,i)=>{i.r(p),i.d(p,{ProfilePageModule:()=>M});var m=i(177),h=i(4341),a=i(4742),g=i(9166),u=i(467),e=i(4438),P=i(1740),v=i(5350),b=i(2291);const k=[{path:"",component:(()=>{var o;class l{constructor(t,n,r,c,s,f){this.authService=t,this.alertController=n,this.router=r,this.feedbackService=c,this.modalController=s,this.fcmService=f,this.notificationsEnabled=!1}ngOnInit(){var t=this;return(0,u.A)(function*(){t.userData$=t.authService.getUserData$()})()}uploadImage(){var t=this;return(0,u.A)(function*(){const n=document.createElement("input");n.type="file",n.accept="image/*",n.onchange=function(){var r=(0,u.A)(function*(c){const s=c.target.files[0];if(s){const f=yield t.authService.getCurrentUserId();if(f)try{yield t.authService.uploadProfilePicture(f,s).toPromise(),t.presentAlert("Success","Profile picture updated successfully."),t.userData$=t.authService.getUserData$()}catch(C){console.error("Error uploading profile picture:",C),t.presentAlert("Error","Failed to update profile picture. Please try again.")}}});return function(c){return r.apply(this,arguments)}}(),n.click()})()}presentAlert(t,n){var r=this;return(0,u.A)(function*(){yield(yield r.alertController.create({header:t,message:n,buttons:["OK"]})).present()})()}signOut(){var t=this;return(0,u.A)(function*(){const n=yield t.authService.getCurrentUserId();n&&(yield t.authService.updateUserStatus(n,!1)),t.authService.logoutUser().then(()=>{console.log("User signed out successfully and marked offline"),t.router.navigate(["/authentication"])}).catch(r=>{console.error("Error signing out:",r)})})()}navigateToForum(){this.userData$.subscribe(t=>{t&&this.router.navigate(["/forum"],{queryParams:{userId:t.uid,avatar:t.profilePictureUrl,role:t.role}})})}openFeedback(){var t=this;return(0,u.A)(function*(){t.router.navigate(["/feedback-modal"]),console.log("Navigated to Feedback page")})()}}return(o=l).\u0275fac=function(t){return new(t||o)(e.rXU(P.k),e.rXU(a.hG),e.rXU(g.Ix),e.rXU(v.n),e.rXU(a.W3),e.rXU(b.Q))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-profile"]],decls:35,vars:9,consts:[[1,"ion-padding"],[1,"background-logo"],[1,"profile-container"],[1,"profile-header"],[1,"profile-image",3,"click"],["alt","Profile picture",3,"src"],[1,"upload-overlay"],["name","camera"],["lines","none"],["button","","detail","true","routerLink","/tabs/edit-profile"],["name","person-outline","slot","start"],["name","notifications-outline","slot","start"],["color","danger","slot","end"],["button","","detail","true",3,"click"],["name","chatbubbles-outline","slot","start"],["button","","detail","true","routerLink","/tabs/report"],["name","flag-outline","slot","start"],["expand","block",3,"click"]],template:function(t,n){if(1&t&&(e.j41(0,"ion-content",0),e.nrm(1,"div",1),e.j41(2,"div",2)(3,"div",3)(4,"div",4),e.bIt("click",function(){return n.uploadImage()}),e.nrm(5,"img",5),e.nI1(6,"async"),e.j41(7,"div",6),e.nrm(8,"ion-icon",7),e.k0s()(),e.j41(9,"h2"),e.EFF(10),e.nI1(11,"async"),e.k0s(),e.j41(12,"p"),e.EFF(13),e.nI1(14,"async"),e.k0s()(),e.j41(15,"ion-list",8)(16,"ion-item",9),e.nrm(17,"ion-icon",10),e.j41(18,"ion-label"),e.EFF(19,"Edit Profile"),e.k0s()(),e.j41(20,"ion-item"),e.nrm(21,"ion-icon",11),e.j41(22,"ion-label"),e.EFF(23,"Push Notification"),e.k0s(),e.nrm(24,"ion-toggle",12),e.k0s(),e.j41(25,"ion-item",13),e.bIt("click",function(){return n.openFeedback()}),e.nrm(26,"ion-icon",14),e.j41(27,"ion-label"),e.EFF(28,"User Feedback"),e.k0s()(),e.j41(29,"ion-item",15),e.nrm(30,"ion-icon",16),e.j41(31,"ion-label"),e.EFF(32,"Report"),e.k0s()()(),e.j41(33,"button",17),e.bIt("click",function(){return n.signOut()}),e.EFF(34,"Sign Out"),e.k0s()()()),2&t){let r,c,s;e.R7$(5),e.Y8G("src",(null==(r=e.bMT(6,3,n.userData$))?null:r.profilePictureUrl)||"./assets/profile-placeholder.jpg",e.B4B),e.R7$(5),e.JRh((null==(c=e.bMT(11,5,n.userData$))?null:c.fullName)||"User Name"),e.R7$(3),e.JRh((null==(s=e.bMT(14,7,n.userData$))?null:s.role)||"Role")}},dependencies:[a.W9,a.iq,a.uz,a.he,a.nf,a.BY,a.hB,a.N7,g.Wk,m.Jj],styles:[".profile-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;height:100%;padding:20px;background-color:transparent}.background-logo[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background-image:url(logo-no-text.13f4a142e83b093f.png);background-size:cover;opacity:.1;z-index:-1}.profile-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:2rem;text-align:center}.profile-image[_ngcontent-%COMP%]{width:120px;height:120px;border-radius:50%;border:4px solid #a00;overflow:hidden;margin-bottom:1rem;position:relative;cursor:pointer}.profile-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.upload-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;background:#00000080;display:flex;justify-content:center;align-items:center;opacity:0;transition:opacity .3s}.profile-image[_ngcontent-%COMP%]:hover   .upload-overlay[_ngcontent-%COMP%]{opacity:1}.upload-overlay[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:2rem;color:#fff}h2[_ngcontent-%COMP%]{margin:0;font-size:1.8rem;font-weight:700}p[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;color:var(--ion-color-medium)}ion-list[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:8px}ion-item[_ngcontent-%COMP%]{--background: #fff;border-radius:8px;margin-bottom:10px;transition:background .3s ease}ion-item[_ngcontent-%COMP%]:hover{--background: #e2e6ea}button[_ngcontent-%COMP%]{margin-top:20px;width:100%;height:7%;background-color:#990008;color:#fff;border:none;border-radius:25px;padding:10px 20px;font-size:16px;font-weight:700;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#a00}"]}),l})()}];let y=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[g.iI.forChild(k),g.iI]}),l})(),M=(()=>{var o;class l{}return(o=l).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[m.MD,h.YN,a.bv,y]}),l})()}}]);